
{% extends "base.html" %}
{% block content %}
  <h1>Support</h1>

  <section class="support-new">
    <h2>Open a new ticket</h2>
    <form method="post" class="form-card">
      <label>Subject
        <input type="text" name="subject" required>
      </label>
      <label>Message
        <textarea name="body" rows="4" required></textarea>
      </label>
      <button class="btn" type="submit">Create ticket</button>
    </form>
  </section>

  <section class="support-list">
    <h2>Your tickets</h2>
    {% if not threads %}
      <p>No tickets yet.</p>
    {% else %}
      <table class="table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Subject</th>
            <th>Created</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          {% for t in threads %}
            <tr>
              <td><a href="{{ url_for('support_thread', thread_id=t.id) }}">#{{ t.id }}</a></td>
              <td>{{ t.subject }}</td>
              <td>{{ t.created_at.strftime("%Y-%m-%d %H:%M") }}</td>
              <td>
                {% if t.is_closed %}
                  Closed
                {% else %}
                  Open
                {% endif %}
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% endif %}
  </section>
{% endblock %}
